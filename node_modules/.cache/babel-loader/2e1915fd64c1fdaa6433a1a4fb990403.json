{"ast":null,"code":"import _slicedToArray from\"C:/Users/\\u041C\\u0438\\u0445\\u0430\\u0438\\u043B/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'../Profile/Profile.css';import React,{useContext,useEffect,useState}from\"react\";import{CurrentUserContext}from\"../context/CurrentUserContext\";import{Link}from\"react-router-dom\";import Header from'../Header/Header';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(props){var currentUser=useContext(CurrentUserContext);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),readOnly=_useState2[0],setReadOnly=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),nameProfile=_useState4[0],setNameProfile=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),emailProfile=_useState6[0],setEmailProfile=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),dataDirty=_useState8[0],setDataDirty=_useState8[1];var _useState9=useState(\"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\"),_useState10=_slicedToArray(_useState9,2),dataError=_useState10[0],setDataError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),formValid=_useState12[0],setFormValid=_useState12[1];var disabledBtn=currentUser.email===emailProfile&&currentUser.name===nameProfile;useEffect(function(){setReadOnly(true);},[]);useEffect(function(){if(dataError){setFormValid(false);}else{setFormValid(true);}},[dataError]);useEffect(function(){setNameProfile(currentUser.name);setEmailProfile(currentUser.email);},[currentUser]);function handleClickEdit(e){e.preventDefault();setReadOnly(false);}function handleChangeName(e){setNameProfile(e.target.value);if(!e.target.validity.valid&&e.target.value.length<3||e.target.value.length>20){setDataError(\"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\");if(!e.target.value){setDataError(\"Имя не может быть пустым\");}}else{setDataError(\"\");}}function handleChangeEmail(e){setEmailProfile(e.target.value);if(!String(e.target.value).toLowerCase().match(/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/)){setDataError(\"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\");if(!e.target.value){setDataError(\"Email не может быть пустым\");}}else{setDataError(\"\");}}function handleSubmit(e){e.preventDefault();props.onUpdateUser({name:nameProfile,email:emailProfile});setReadOnly(true);}function blurHandler(e){switch(e.target.name){case\"nameprofile\":setDataDirty(true);break;case\"emailprofile\":setDataDirty(true);break;default:break;}}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"form\",{className:\"profile__form\",action:\"/\",name:\"formprofile\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"p\",{className:\"profile__greeting\",children:[\"\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \",currentUser.name,\"!\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__box-profile-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__profile-info\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"profile__info\",children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{className:\"profile__input\",type:\"text\",name:\"nameprofile\",id:\"nameprofile\",minLength:\"2\",maxLength:\"20\",value:nameProfile?nameProfile:\"\",onChange:handleChangeName,required:true,readOnly:readOnly,onBlur:blurHandler,autoComplete:\"off\"})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"profile__line\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__profile-info\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"profile__info\",children:\"E-mail\"}),/*#__PURE__*/_jsx(\"input\",{className:\"profile__input\",id:\"emailprofile\",name:\"emailprofile\",minLength:\"2\",maxLength:\"100\",value:emailProfile?emailProfile:\"\",onChange:handleChangeEmail,required:true,readOnly:readOnly,onBlur:blurHandler,autoComplete:\"off\"})]}),dataDirty&&dataError&&/*#__PURE__*/_jsx(\"div\",{className:\"profile__error\",children:dataError})]}),!readOnly?/*#__PURE__*/_jsx(\"button\",{className:\"button profile__button-edit\",disabled:!formValid||disabledBtn,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}):/*#__PURE__*/_jsx(\"button\",{className:\"button profile__button-edit\",onClick:handleClickEdit,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(Link,{className:\"profile__link-exit\",to:\"/\",onClick:props.handleSignOut,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438 \\u0438\\u0437 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\\u0430\"})]});}export default Profile;","map":{"version":3,"names":["React","useContext","useEffect","useState","CurrentUserContext","Link","Header","Profile","props","currentUser","readOnly","setReadOnly","nameProfile","setNameProfile","emailProfile","setEmailProfile","dataDirty","setDataDirty","dataError","setDataError","formValid","setFormValid","disabledBtn","email","name","handleClickEdit","e","preventDefault","handleChangeName","target","value","validity","valid","length","handleChangeEmail","String","toLowerCase","match","handleSubmit","onUpdateUser","blurHandler","handleSignOut"],"sources":["C:/Users/Михаил/dev/movies-explorer-frontend/src/components/Profile/Profile.js"],"sourcesContent":["import '../Profile/Profile.css';\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { CurrentUserContext } from \"../context/CurrentUserContext\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Header from '../Header/Header';\r\n\r\n\r\n\r\nfunction Profile(props) {\r\n\r\n  const currentUser = useContext(CurrentUserContext);\r\n\r\n  const [readOnly, setReadOnly] = useState(true);\r\n  const [nameProfile, setNameProfile] = useState(\"\");\r\n  const [emailProfile, setEmailProfile] = useState(\"\");\r\n  const [dataDirty, setDataDirty] = useState(false);\r\n  const [dataError, setDataError] = useState(\r\n    \"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\"\r\n  );\r\n\r\n  const [formValid, setFormValid] = useState(false);\r\n  const disabledBtn =\r\n    currentUser.email === emailProfile && currentUser.name === nameProfile;\r\n\r\n  useEffect(() => {\r\n    setReadOnly(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (dataError) {\r\n      setFormValid(false);\r\n    } else {\r\n      setFormValid(true);\r\n    }\r\n  }, [dataError]);\r\n\r\n  useEffect(() => {\r\n    setNameProfile(currentUser.name);\r\n    setEmailProfile(currentUser.email);\r\n  }, [currentUser]);\r\n\r\n  function handleClickEdit(e) {\r\n    e.preventDefault();\r\n    setReadOnly(false);\r\n  }\r\n\r\n  function handleChangeName(e) {\r\n    setNameProfile(e.target.value);\r\n    if (\r\n      (!e.target.validity.valid && e.target.value.length < 3) ||\r\n      e.target.value.length > 20\r\n    ) {\r\n      setDataError(\r\n        \"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\"\r\n      );\r\n      if (!e.target.value) {\r\n        setDataError(\"Имя не может быть пустым\");\r\n      }\r\n    } else {\r\n      setDataError(\"\");\r\n    }\r\n  }\r\n\r\n  function handleChangeEmail(e) {\r\n    setEmailProfile(e.target.value);\r\n    if (\r\n      !String(e.target.value)\r\n        .toLowerCase()\r\n        .match(\r\n          /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n        )\r\n    ) {\r\n      setDataError(\r\n        \"Что-то пошло не так. Имя не должно быть пустым или некорректный Email\"\r\n      );\r\n      if (!e.target.value) {\r\n        setDataError(\"Email не может быть пустым\");\r\n      }\r\n    } else {\r\n      setDataError(\"\");\r\n    }\r\n  }\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    props.onUpdateUser({\r\n      name: nameProfile,\r\n      email: emailProfile,\r\n    });\r\n    setReadOnly(true);\r\n  }\r\n\r\n  function blurHandler(e) {\r\n    switch (e.target.name) {\r\n      case \"nameprofile\":\r\n        setDataDirty(true);\r\n        break;\r\n      case \"emailprofile\":\r\n        setDataDirty(true);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n    return (\r\n      <div className=\"profile\">\r\n        <Header />\r\n        <form\r\n          className=\"profile__form\"\r\n          action=\"/\"\r\n          name=\"formprofile\"\r\n          onSubmit={handleSubmit}\r\n        >\r\n          <p className=\"profile__greeting\">Привет, {currentUser.name}!</p>\r\n          <div className=\"profile__box-profile-info\">\r\n            <div className=\"profile__profile-info\">\r\n              <p className=\"profile__info\">Имя</p>\r\n              <input\r\n                className=\"profile__input\"\r\n                type=\"text\"\r\n                name=\"nameprofile\"\r\n                id=\"nameprofile\"\r\n                minLength=\"2\"\r\n                maxLength=\"20\"\r\n                value={nameProfile ? nameProfile : \"\"}\r\n                onChange={handleChangeName}\r\n                required\r\n                readOnly={readOnly}\r\n                onBlur={blurHandler}\r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n            <hr className=\"profile__line\" />\r\n            <div className=\"profile__profile-info\">\r\n              <p className=\"profile__info\">E-mail</p>\r\n              <input\r\n                className=\"profile__input\"\r\n                id=\"emailprofile\"\r\n                name=\"emailprofile\"\r\n                minLength=\"2\"\r\n                maxLength=\"100\"\r\n                value={emailProfile ? emailProfile : \"\"}\r\n                onChange={handleChangeEmail}\r\n                required\r\n                readOnly={readOnly}\r\n                onBlur={blurHandler}\r\n                autoComplete=\"off\"\r\n              />\r\n            </div>\r\n            {dataDirty && dataError && (\r\n              <div className=\"profile__error\">{dataError}</div>\r\n            )}\r\n          </div>\r\n          {!readOnly ? (\r\n            <button\r\n              className=\"button profile__button-edit\"\r\n              disabled={!formValid || disabledBtn}\r\n            >\r\n              Сохранить\r\n            </button>\r\n          ) : (\r\n            <button\r\n              className=\"button profile__button-edit\"\r\n              onClick={handleClickEdit}\r\n            >\r\n              Редактировать\r\n            </button>\r\n          )}\r\n        </form>\r\n        <Link\r\n          className=\"profile__link-exit\"\r\n          to=\"/\"\r\n          onClick={props.handleSignOut}\r\n        >\r\n          Выйти из аккаунта\r\n        </Link>\r\n      </div>\r\n    );\r\n  }\r\n\r\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module"}